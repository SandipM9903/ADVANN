üî• Now we are entering real e-commerce product service level.

‚úÖ STEP 1: CATEGORY MODULE (First)

Because without Category, Product service is incomplete.

======================================================================================

‚úÖ 1Ô∏è‚É£ Create Category Entity

üìå com.advann.product_service.entity.Category

package com.advann.product_service.entity;


import jakarta.persistence.*;
import lombok.*;


@Entity
@Table(name = "categories")
@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class Category {


    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;


    @Column(nullable = false, unique = true)
    private String name;
}

=======================================================================================================================


‚úÖ 2Ô∏è‚É£ Update Product Entity (Add Category Relation)

üìå Product.java

Add this field:

@ManyToOne
@JoinColumn(name = "category_id")
private Category category;

=======================================================================================================================

‚úÖ 3Ô∏è‚É£ Create Category Repository

üìå com.advann.product_service.repository.CategoryRepository

package com.advann.product_service.repository;


import com.advann.product_service.entity.Category;
import org.springframework.data.jpa.repository.JpaRepository;


import java.util.Optional;


public interface CategoryRepository extends JpaRepository<Category, Long> {


    Optional<Category> findByName(String name);


    boolean existsByName(String name);
}

=======================================================================================================================

‚úÖ 4Ô∏è‚É£ Create Category DTOs

üìå dto/CategoryRequestDto.java

package com.advann.product_service.dto;


import jakarta.validation.constraints.NotBlank;
import lombok.Data;


@Data
public class CategoryRequestDto {


    @NotBlank(message = "Category name is required")
    private String name;
}

üìå dto/CategoryResponseDto.java

package com.advann.product_service.dto;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class CategoryResponseDto {
    private Long id;
    private String name;
}
=======================================================================================================

‚úÖ 5Ô∏è‚É£ Create Category Service Interface

üìå service/services/CategoryService.java

package com.advann.product_service.service.services;


import com.advann.product_service.dto.CategoryRequestDto;
import com.advann.product_service.dto.CategoryResponseDto;


import java.util.List;


public interface CategoryService {


    CategoryResponseDto createCategory(CategoryRequestDto requestDto);


    List<CategoryResponseDto> getAllCategories();


    CategoryResponseDto getCategoryById(Long id);


    void deleteCategory(Long id);
}

=========================================================================================================

‚úÖ 6Ô∏è‚É£ Create CategoryServiceImpl

üìå service/serviceImpl/CategoryServiceImpl.java

package com.advann.product_service.service.serviceImpl;


import com.advann.product_service.dto.CategoryRequestDto;
import com.advann.product_service.dto.CategoryResponseDto;
import com.advann.product_service.entity.Category;
import com.advann.product_service.exceptions.ResourceNotFoundException;
import com.advann.product_service.repository.CategoryRepository;
import com.advann.product_service.service.services.CategoryService;
import lombok.RequiredArgsConstructor;
import org.modelmapper.ModelMapper;
import org.springframework.stereotype.Service;


import java.util.List;


@Service
@RequiredArgsConstructor
public class CategoryServiceImpl implements CategoryService {


    private final CategoryRepository categoryRepository;
    private final ModelMapper modelMapper;


    @Override
    public CategoryResponseDto createCategory(CategoryRequestDto requestDto) {


        if (categoryRepository.existsByName(requestDto.getName())) {
            throw new RuntimeException("Category already exists: " + requestDto.getName());
        }


        Category category = Category.builder()
                .name(requestDto.getName())
                .build();


        Category saved = categoryRepository.save(category);


        return modelMapper.map(saved, CategoryResponseDto.class);
    }


    @Override
    public List<CategoryResponseDto> getAllCategories() {


        return categoryRepository.findAll()
                .stream()
                .map(cat -> modelMapper.map(cat, CategoryResponseDto.class))
                .toList();
    }


    @Override
    public CategoryResponseDto getCategoryById(Long id) {


        Category category = categoryRepository.findById(id)
                .orElseThrow(() -> new ResourceNotFoundException("Category not found with id: " + id));


        return modelMapper.map(category, CategoryResponseDto.class);
    }


    @Override
    public void deleteCategory(Long id) {


        Category category = categoryRepository.findById(id)
                .orElseThrow(() -> new ResourceNotFoundException("Category not found with id: " + id));


        categoryRepository.delete(category);
    }
}

=================================================================================================================================

‚úÖ 7Ô∏è‚É£ Create Category Controller

üìå controller/CategoryController.java

package com.advann.product_service.controller;


import com.advann.product_service.dto.CategoryRequestDto;
import com.advann.product_service.dto.CategoryResponseDto;
import com.advann.product_service.payload.ApiResponse;
import com.advann.product_service.service.services.CategoryService;
import jakarta.validation.Valid;
import lombok.RequiredArgsConstructor;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;


import java.util.List;


@RestController
@RequestMapping("/api/categories")
@RequiredArgsConstructor
public class CategoryController {


    private final CategoryService categoryService;


    @PostMapping
    public ResponseEntity<ApiResponse<CategoryResponseDto>> createCategory(
            @Valid @RequestBody CategoryRequestDto requestDto) {


        CategoryResponseDto responseDto = categoryService.createCategory(requestDto);


        return ResponseEntity.ok(
                ApiResponse.<CategoryResponseDto>builder()
                        .success(true)
                        .message("Category created successfully")
                        .data(responseDto)
                        .build()
        );
    }


    @GetMapping
    public ResponseEntity<ApiResponse<List<CategoryResponseDto>>> getAllCategories() {


        List<CategoryResponseDto> categories = categoryService.getAllCategories();


        return ResponseEntity.ok(
                ApiResponse.<List<CategoryResponseDto>>builder()
                        .success(true)
                        .message("Categories fetched successfully")
                        .data(categories)
                        .build()
        );
    }


    @GetMapping("/{id}")
    public ResponseEntity<ApiResponse<CategoryResponseDto>> getCategoryById(@PathVariable Long id) {


        CategoryResponseDto category = categoryService.getCategoryById(id);


        return ResponseEntity.ok(
                ApiResponse.<CategoryResponseDto>builder()
                        .success(true)
                        .message("Category fetched successfully")
                        .data(category)
                        .build()
        );
    }


    @DeleteMapping("/{id}")
    public ResponseEntity<ApiResponse<String>> deleteCategory(@PathVariable Long id) {


        categoryService.deleteCategory(id);


        return ResponseEntity.ok(
                ApiResponse.<String>builder()
                        .success(true)
                        .message("Category deleted successfully")
                        .data("Deleted category id: " + id)
                        .build()
        );
    }
}

==============================================================================================================================

‚úÖ STEP 2: Update Product DTOs (Category Support)

Now update:

üìå ProductRequestDto

Add:

private Long categoryId;

üìå ProductResponseDto

Add:

private Long categoryId;
private String categoryName;

===================================================================================================================

‚úÖ STEP 3: Update ProductServiceImpl to Save Category

In ProductServiceImpl while saving product:

@Override
    public ProductResponseDto addProduct(ProductRequestDto productRequestDto) {

        log.info("Creating new product with name: {}", productRequestDto.getName());

        Product product = modelMapper.map(productRequestDto, Product.class);

        Category category = categoryRepository.findById(productRequestDto.getCategoryId())
                .orElseThrow(() -> new ResourceNotFoundException(
                        "Category not found with id: " + productRequestDto.getCategoryId()
                ));

        product.setCategory(category);

        Product savedProduct = productRepository.save(product);

        log.info("Product created successfully with id: {}", savedProduct.getId());

        ProductResponseDto responseDto = modelMapper.map(savedProduct, ProductResponseDto.class);

        responseDto.setCategoryId(category.getId());
        responseDto.setCategoryName(category.getName());

        return responseDto;
    }