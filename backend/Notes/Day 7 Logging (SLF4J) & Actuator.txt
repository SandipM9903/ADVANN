Day 7 Notes: Logging + Actuator + Gateway Monitoring
âœ… Topics Covered

âœ… Logging using SLF4J (Service Layer Logging)
âœ… Spring Boot Actuator (Health + Info Monitoring)
âœ… Exposing Actuator endpoints through API Gateway
âœ… Adding application metadata in /actuator/info

âœ… Why we use Spring Boot Actuator?

Spring Boot Actuator is used to monitor and manage applications while running.

It provides ready-made endpoints like:

Health status (/actuator/health)

Application info (/actuator/info)

Metrics (CPU, memory, request count)

Beans loaded in Spring

Environment properties

Change log levels at runtime

âœ… Actuator Endpoint Testing
Health Endpoint

ðŸ‘‰ http://localhost:8081/actuator/health

Expected Response:

{
  "status": "UP"
}
Info Endpoint

ðŸ‘‰ http://localhost:8081/actuator/info

âœ… Step 1: Add Actuator Dependency (Product Service)

In product-service pom.xml add:

<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-actuator</artifactId>
</dependency>
âœ… Step 2: Configure Actuator Endpoints in application.yml

In product-service application.yml add:

management:
  endpoints:
    web:
      exposure:
        include: health,info


  endpoint:
    health:
      show-details: always

Now actuator endpoints will be enabled.

âœ… Step 3: Logging in Service Layer (SLF4J)

Logging is used to track execution flow and debug issues.

In ProductServiceImpl.java, add imports:

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

Then inside class:

private static final Logger log = LoggerFactory.getLogger(ProductServiceImpl.class);
âœ… Step 4: Add Logs inside Service Methods

Logging should be added in:

âœ… addProduct
âœ… getAllProducts
âœ… getProductById
âœ… updateProduct
âœ… deleteProduct

Example logs:

log.info("Creating new product with name: {}", productRequestDto.getName());
log.info("Product created successfully with id: {}", savedProduct.getId());
log.warn("Product not found with id: {}", id);
âœ… Final ProductServiceImpl.java (Logging Code)
package com.advann.product_service.service.serviceImpl;


import com.advann.product_service.dto.ProductRequestDto;
import com.advann.product_service.dto.ProductResponseDto;
import com.advann.product_service.entity.Product;
import com.advann.product_service.exceptions.ResourceNotFoundException;
import com.advann.product_service.repository.ProductRepository;
import com.advann.product_service.service.services.ProductService;
import lombok.RequiredArgsConstructor;
import org.modelmapper.ModelMapper;
import org.springframework.stereotype.Service;


import org.slf4j.Logger;
import org.slf4j.LoggerFactory;


import java.util.List;
import java.util.stream.Collectors;


@Service
@RequiredArgsConstructor
public class ProductServiceImpl implements ProductService {


    private static final Logger log = LoggerFactory.getLogger(ProductServiceImpl.class);


    private final ProductRepository productRepository;
    private final ModelMapper modelMapper;


    @Override
    public ProductResponseDto addProduct(ProductRequestDto productRequestDto) {


        log.info("Creating new product with name: {}", productRequestDto.getName());


        Product product = modelMapper.map(productRequestDto, Product.class);


        Product savedProduct = productRepository.save(product);


        log.info("Product created successfully with id: {}", savedProduct.getId());


        return modelMapper.map(savedProduct, ProductResponseDto.class);
    }


    @Override
    public List<ProductResponseDto> getAllProducts() {


        log.info("Fetching all products");


        List<Product> products = productRepository.findAll();


        log.info("Total products found: {}", products.size());


        return products.stream()
                .map(product -> modelMapper.map(product, ProductResponseDto.class))
                .collect(Collectors.toList());
    }


    @Override
    public ProductResponseDto getProductById(Long id) {


        log.info("Fetching product by id: {}", id);


        Product product = productRepository.findById(id)
                .orElseThrow(() -> {
                    log.warn("Product not found with id: {}", id);
                    return new ResourceNotFoundException("Product not found with id: " + id);
                });


        log.info("Product found with id: {}", id);


        return modelMapper.map(product, ProductResponseDto.class);
    }


    @Override
    public ProductResponseDto updateProduct(Long id, ProductRequestDto productRequestDto) {


        log.info("Updating product with id: {}", id);


        Product existing = productRepository.findById(id)
                .orElseThrow(() -> {
                    log.warn("Cannot update. Product not found with id: {}", id);
                    return new ResourceNotFoundException("Product not found with id: " + id);
                });


        existing.setName(productRequestDto.getName());
        existing.setPrice(productRequestDto.getPrice());
        existing.setQuantity(productRequestDto.getQuantity());


        Product updated = productRepository.save(existing);
âœ… Step 5: Enable /actuator/info output (Important Fix)

By default, /actuator/info returns {} unless we configure info properties.

So add this in application.yml:

management:
  info:
    env:
      enabled: true
âœ… Step 6: Add Application Info Metadata

In application.yml:

info:
  app:
    name: Product Service
    description: Product Microservice for Advann
    version: 1.0.0

Now /actuator/info will show application details.

âœ… Final application.yml (Complete Correct Version)
server:
  port: 8081


spring:
  application:
    name: product-service


  datasource:
    url: jdbc:postgresql://localhost:5432/advann_db
    username: postgres
    password: root


  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true


eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/


management:
  endpoints:
    web:
      exposure:
        include: health,info


  endpoint:
    health:
      show-details: always


  info:
    env:
      enabled: true


info:
  app:
    name: Product Service
    description: Product Microservice for Advann
    version: 1.0.0


logging:
  level:
    com.advann.product_service: INFO
âœ… Gateway Monitoring (What We Implemented)
Direct Service Access

ðŸ‘‰ http://localhost:8081/actuator/health

Gateway Access (Recommended in real microservices)

ðŸ‘‰ http://localhost:8080/product-service/actuator/health

ðŸ‘‰ http://localhost:8080/product-service/actuator/info

This is called Gateway Monitoring because the gateway becomes the single entry point for checking health of all microservices.